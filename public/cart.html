<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shopping Cart - Grocery Portal</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <!-- Navbar -->
  <header>
    <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
      <div class="container">
        <a class="navbar-brand fw-bold" href="index.html">Grocery Portal</a>
      </div>
    </nav>
  </header>

  <!-- Cart Section -->
  <main class="container my-5">
    <h2 class="mb-4">Your Cart</h2>
    <table class="table table-bordered align-middle">
      <thead class="table-light">
        <tbody id="cart-items"></tbody>

      </thead>
      <tbody id="cart-body">
        <!-- Items will load dynamically -->
      </tbody>
    </table>
    <div class="text-end">
      <h4 id="cart-total">Total: ₹0</h4>
      <a href="checkout.html" class="btn btn-success">Proceed to Checkout</a>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-light text-center py-3 border-top">
    <p class="mb-0">© 2025 Grocery Portal. All rights reserved.</p>
  </footer>

  <!-- Cart Script -->
  <script>
    const CART_KEY = 'grocery_cart_v1';

    function renderCart() {
      const cart = JSON.parse(localStorage.getItem(CART_KEY) || '[]');
      const body = document.getElementById('cart-body');
      body.innerHTML = '';
      let total = 0;

      cart.forEach(item => {
        const subtotal = item.price * item.qty;
        total += subtotal;
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${item.name}</td>
          <td>₹${item.price}</td>
          <td>
            <input type="number" min="1" value="${item.qty}" 
              data-id="${item.id}" class="form-control qty-input" style="width:80px;">
          </td>
          <td>₹${subtotal}</td>
          <td><button class="btn btn-danger btn-sm remove-btn" data-id="${item.id}">Remove</button></td>
        `;
        body.appendChild(tr);
      });

      document.getElementById('cart-total').textContent = 'Total: ₹' + total;
      attachCartHandlers();
    }

    function attachCartHandlers() {
      document.querySelectorAll('.remove-btn').forEach(b => {
        b.onclick = () => {
          const id = b.dataset.id;
          let cart = JSON.parse(localStorage.getItem(CART_KEY) || '[]');
          cart = cart.filter(i => i.id !== id);
          localStorage.setItem(CART_KEY, JSON.stringify(cart));
          renderCart();
        };
      });

      document.querySelectorAll('.qty-input').forEach(input => {
        input.onchange = () => {
          const id = input.dataset.id;
          const qty = parseInt(input.value, 10) || 1;
          const cart = JSON.parse(localStorage.getItem(CART_KEY) || '[]');
          const idx = cart.findIndex(i => i.id === id);
          if (idx >= 0) {
            cart[idx].qty = qty;
            localStorage.setItem(CART_KEY, JSON.stringify(cart));
            renderCart();
          }
        };
      });
    }
    function loadCart() {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    let cartTable = document.getElementById("cart-items");
    let total = 0;
    cartTable.innerHTML = "";

    cart.forEach((item, index) => {
      let subtotal = item.price * item.quantity;
      total += subtotal;
      cartTable.innerHTML += `
        <tr>
          <td><img src="${item.image}" width="50"> ${item.name}</td>
          <td>₹${item.price}</td>
          <td>
            <input type="number" min="1" value="${item.quantity}" 
              onchange="updateQuantity(${index}, this.value)" class="form-control" style="width:80px;">
          </td>
          <td>₹${subtotal}</td>
          <td><button class="btn btn-danger btn-sm" onclick="removeItem(${index})">Remove</button></td>
        </tr>`;
    });

    document.getElementById("cart-total").innerText = "₹" + total;
  }

  function updateQuantity(index, qty) {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart[index].quantity = parseInt(qty);
    localStorage.setItem("cart", JSON.stringify(cart));
    loadCart();
  }

  function removeItem(index) {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart.splice(index, 1);
    localStorage.setItem("cart", JSON.stringify(cart));
    loadCart();
  }

  window.onload = loadCart;

    document.addEventListener('DOMContentLoaded', renderCart);
  </script>
  <h4>Total: <span id="cart-total">₹0</span></h4>

</body>
</html>
